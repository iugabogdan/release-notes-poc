name: Release

on:
  workflow_dispatch:

jobs:
  release:
    permissions:
      contents: write
      issues: write
      pull-requests: write
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: docker build -t semantic-release .
      - run: |
          docker run \
            -e GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }} \
            -e CI=true \
            -e SLACK_WEBHOOK=https://hooks.slack.com/services/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 \
            -v ${{ github.workspace }}:/app \
            -w /app \
            semantic-release \
            /bin/sh -c "npx semantic-release"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
